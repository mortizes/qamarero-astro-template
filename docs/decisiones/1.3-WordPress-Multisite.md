# 1.3 - Â¿WordPress Single Site o Multisite?

## ğŸ“‹ Contexto

**Depende de:** 1.2 (Haber elegido WordPress como CMS)
**Afecta a:** 4.3 (SegregaciÃ³n de permisos por paÃ­s)

**Requisitos Qamarero:**
- SegregaciÃ³n: Editor ES NO puede ver/editar contenido FR
- AutonomÃ­a: Cada paÃ­s gestiona su blog independientemente
- SEO independiente: Cada paÃ­s configura su propio Yoast/meta tags
- Escalabilidad: Poder aÃ±adir IT, EN sin afectar ES/FR

**Importante - QuÃ© NO necesitamos:**
- âŒ NO necesitamos plugins de traducciÃ³n (WPML, Polylang)
- âŒ NO necesitamos relacionar posts entre idiomas
- âŒ NO necesitamos sincronizaciÃ³n de contenido
- âŒ Los posts del blog son contenido diferente por paÃ­s, NO traducciones

**Por quÃ©:**
- El blog ES y el blog FR tienen **contenido completamente diferente**
- Un post "5 ideas menÃº del dÃ­a" en ES NO tiene equivalente en FR
- Carlos FR publica contenido francÃ©s original, NO traducciones de ES
- Las traducciones solo aplican al contenido corporativo (hardcodeado en Astro)

---

## ğŸ¯ DecisiÃ³n

**Pregunta fundamental:**
**"Â¿Usamos Single Site con todos los idiomas juntos, o Multisite con site independiente por idioma?"**

---

## âš–ï¸ Opciones

### OpciÃ³n A: Single Site (Todos los idiomas juntos)

**Arquitectura:**
```
WordPress Ãºnico:
â”œâ”€â”€ Todos los idiomas en mismo dashboard
â”œâ”€â”€ Posts ES, FR, EN mezclados en misma BD
â””â”€â”€ Roles: Editor ve TODOS los posts de todos los idiomas
```

**Flujo editorial (problemÃ¡tico):**
```
Editor ES publica post
    â†“
Ve posts FR en mismo dashboard
    â†“
Puede editar post FR por error
    â†“
Riesgo: Carlos encuentra su post modificado âš ï¸
```

#### Contras para Qamarero

**1. Sin segregaciÃ³n real**
```
Problema:
â”œâ”€ Marketing ES ve posts FR en dashboard
â”œâ”€ Puede filtrar, pero puede ver/editar
â””â”€ Depende de disciplina humana, no de arquitectura âŒ
```

**2. AutonomÃ­a limitada**
```
ConfiguraciÃ³n global:
â”œâ”€ Yoast SEO: Templates afectan TODOS idiomas
â”œâ”€ Plugins: Activar/desactivar afecta TODOS
â””â”€ FR no puede tener estrategia SEO diferente âŒ
```

#### CuÃ¡ndo usar Single Site

```
âœ… 1 sola persona edita TODO el contenido
âœ… Blog muy pequeÃ±o (<10 posts total)
âŒ NO aplica a Qamarero (equipos separados por paÃ­s)
```

---

### OpciÃ³n B: WordPress Multisite (1 site por idioma) â­

**Arquitectura:**
```
Network WordPress:
â”œâ”€â”€ Site 1: qamarero.com (ES)
â”œâ”€â”€ Site 2: qamarero.com/fr (FR)
â”œâ”€â”€ Site 3: qamarero.com/en (EN - futuro)
â””â”€â”€ Site 4: qamarero.com/it (IT - futuro)

Cada site:
â”œâ”€â”€ BD completamente independiente
â”œâ”€â”€ Admin completamente independiente
â”œâ”€â”€ Plugins y configuraciÃ³n independientes
â”œâ”€â”€ Contenido 100% diferente (NO traducciones)
â””â”€â”€ Como si fueran WordPress separados âœ…
```

**Flujo editorial:**
```
Marketing ES (9:00):
â”œâ”€ Abre wp-admin de qamarero.com (site ES)
â”œâ”€ Ve SOLO posts en espaÃ±ol
â”œâ”€ NO puede acceder a admin FR (arquitectura lo impide)
â””â”€ Publica "5 ideas para menÃº del dÃ­a"

Carlos FR (10:00):
â”œâ”€ Abre wp-admin de qamarero.com/fr (site FR)
â”œâ”€ Ve SOLO posts en francÃ©s
â”œâ”€ NO puede acceder a admin ES
â””â”€ Publica "Les tendances restauration 2026" (contenido diferente)

Nota: NO hay relaciÃ³n entre los posts âœ…
Cada paÃ­s publica contenido original, NO traducciones
```

#### Pros

**1. SegregaciÃ³n total (arquitectura)**
```
Editor ES:
â”œâ”€ NO puede acceder a admin FR (error 403)
â”œâ”€ NO ve posts FR en ningÃºn lado
â”œâ”€ NO existe dropdown para cambiar idioma
â””â”€ Imposible equivocarse âœ…
```

**2. AutonomÃ­a completa**
```
Site FR:
â”œâ”€ Instalar plugins diferentes
â”œâ”€ Configurar Yoast con templates FR
â”œâ”€ Estrategia SEO independiente
â””â”€ Cambios NO afectan site ES âœ…
```

**3. Contenido independiente**
```
Posts ES â‰  Posts FR
â”œâ”€ NO son traducciones
â”œâ”€ NO estÃ¡n relacionados
â”œâ”€ Contenido 100% diferente
â””â”€ Sin plugins de traducciÃ³n necesarios âœ…
```

**4. Escalabilidad**
```
AÃ±adir site IT:
â”œâ”€ Crear nuevo site en network (15 min)
â”œâ”€ 0 impacto en ES/FR existentes
â””â”€ Escalable a 4+ idiomas âœ…
```

**5. Sin coste adicional**
```
Multisite:
â”œâ”€ Feature nativo de WordPress
â”œâ”€ Cloudways lo soporta sin extra
â”œâ”€ $0 adicional (vs $99/aÃ±o WPML)
â””â”€ Sin plugins de traducciÃ³n âœ…
```

#### Contras aceptados

**1. Media Library separada**
```
Imagen subida en ES:
â”œâ”€ NO aparece en FR (debe re-subir)
â””â”€ OK porque son posts diferentes âœ…
```

**2. Plugins por site**
```
WPGraphQL:
â”œâ”€ Instalar en cada site
â””â”€ Automatizable con script âœ…
```

#### MÃ©tricas

| MÃ©trica | Valor | Target |
|---------|-------|--------|
| SegregaciÃ³n | âœ… Total (imposible acceder otro site) | âœ… Total |
| AutonomÃ­a | âœ… Completa (config independiente) | âœ… Completa |
| Plugins traducciÃ³n | âœ… $0 (no necesarios) | âœ… $0 |
| Setup time | ~30 min | âœ… <40 min |

#### CuÃ¡ndo usar Multisite

```
âœ… Equipos separados por paÃ­s (marketing ES, Carlos FR)
âœ… Contenido diferente por paÃ­s (NO traducciones)
âœ… AutonomÃ­a necesaria (plugins, SEO independientes)
âœ… Escalabilidad (4+ idiomas futuros)
âœ… Este es nuestro caso (Qamarero) âœ…
```

---

## ğŸ“Š ComparaciÃ³n Final

| Criterio | Single Site | Multisite â­ |
|----------|-------------|--------------|
| **SegregaciÃ³n** | âš ï¸ DÃ©bil (puede ver otros idiomas) | âœ… Total (arquitectura) |
| **AutonomÃ­a** | âŒ Limitada (config global) | âœ… Completa |
| **Plugins traducciÃ³n** | Necesarios (WPML $99/aÃ±o) | âœ… NO necesarios ($0) |
| **Contenido** | Mezclado en mismo dashboard | âœ… Independiente por site |
| **Escalabilidad** | âš ï¸ Aceptable | âœ… Excelente |
| **Para Qamarero** | âŒ No cumple segregaciÃ³n | âœ… IDEAL |

---

## ğŸ’¡ Propuesta: Multisite

### Por quÃ© para Qamarero

**1. SegregaciÃ³n real (arquitectura, no disciplina)**
```
Multisite:
â””â”€ Editor ES NO PUEDE acceder a FR (error 403)

vs Single Site:
â””â”€ Editor ES PUEDE ver FR (depende de disciplina)
```

**2. Contenido independiente (NO traducciones)**
```
Blog ES:
â”œâ”€ "5 ideas menÃº del dÃ­a"
â”œâ”€ "CÃ³mo reducir food waste"
â””â”€ Contenido original espaÃ±ol

Blog FR:
â”œâ”€ "Les tendances restauration 2026"
â”œâ”€ "Comment optimiser votre carte"
â””â”€ Contenido original francÃ©s (NO traducciones)

Los posts NO tienen relaciÃ³n entre sÃ­ âœ…
```

**3. Sin plugins de traducciÃ³n**
```
NO necesitamos:
â”œâ”€ WPML ($99/aÃ±o)
â”œâ”€ Polylang
â”œâ”€ NingÃºn plugin de traducciÃ³n
â””â”€ Ahorro: $99/aÃ±o âœ…
```

**4. Caso validado**
> **Lole (Cabify):** GestionÃ³ WordPress Multisite para 8+ paÃ­ses (ES, MX, PE, CL, etc.). Cada paÃ­s tenÃ­a contenido 100% diferente, equipos trabajaban independientemente.

---

## âš ï¸ Trade-offs Aceptados

| Trade-off | Aceptado porque... |
|-----------|----------------------|
| Media Library separada | Posts son contenido diferente, no traducciones |
| Plugins por site | Automatizable con script |
| Setup inicial (30 min) | SegregaciÃ³n total vale la pena |

---

## ğŸ§ª ValidaciÃ³n en POC

### Test 1.3.1: SegregaciÃ³n de Permisos

**Setup:**
```
Users:
â”œâ”€ marketing-es@qamarero.com: Editor en site ES
â”œâ”€ carlos@qamarero.com: Editor en site FR
â””â”€ miguel@qamarero.com: Super Admin (network)
```

**Tests:**
```
Test A: Editor ES intenta acceder FR
1. Login como marketing-es@qamarero.com
2. Dashboard muestra SOLO posts ES
3. Intentar acceder qamarero.com/fr/wp-admin
4. Resultado esperado: Error 403 "No tienes permiso" âœ…

Test B: Editor FR intenta acceder ES
1. Login como carlos@qamarero.com
2. Dashboard muestra SOLO posts FR
3. Intentar acceder qamarero.com/wp-admin
4. Resultado esperado: Error 403 "No tienes permiso" âœ…
```

**MÃ©tricas:**
- [ ] Editor ES NO puede acceder a admin FR: 100%
- [ ] Editor FR NO puede acceder a admin ES: 100%

---

### Test 1.3.2: Contenido Independiente

**Setup:**
```
Site ES:
â””â”€ Crear post "5 ideas menÃº del dÃ­a"

Site FR:
â””â”€ Crear post "Les tendances restauration" (contenido diferente)
```

**Tests:**
```
Test A: Posts NO relacionados
1. Post ES y post FR existen independientes
2. NO hay campo "traducciÃ³n de..."
3. NO hay link entre ellos
4. Contenido completamente diferente âœ…

Test B: GraphQL independiente
1. Query a /graphql â†’ Solo posts ES
2. Query a /fr/graphql â†’ Solo posts FR
3. 0 mezcla de contenido âœ…
```

**MÃ©tricas:**
- [ ] Posts son independientes (sin relaciÃ³n): 100%
- [ ] GraphQL endpoints independientes: 100%

---

### Test 1.3.3: Escalabilidad (AÃ±adir IT)

**Setup:**
```
Crear site IT:
â”œâ”€ URL: qamarero.com/it
â”œâ”€ Instalar WPGraphQL
â”œâ”€ Crear usuario Editor IT
â””â”€ Crear 1 post de prueba
```

**Tests:**
```
Test A: Nuevo site NO afecta existentes
1. Site IT creado
2. Site ES sigue funcionando
3. Site FR sigue funcionando
4. Resultado: 0 impacto âœ…

Test B: Tiempo de setup
1. Crear site en network
2. Configurar bÃ¡sico
3. Tiempo total: <15 min âœ…
```

**MÃ©tricas:**
- [ ] AÃ±adir nuevo idioma: <15 min
- [ ] 0 impacto en sites existentes

---

### Test 1.3.4: GraphQL Endpoints

**Setup:**
```
Endpoints:
â”œâ”€ ES: https://qamarero.com/graphql
â”œâ”€ FR: https://qamarero.com/fr/graphql
â””â”€ EN: https://qamarero.com/en/graphql (futuro)
```

**Uso en Astro:**
```typescript
// src/lib/wordpress.ts
const GRAPHQL_ENDPOINTS = {
  es: 'https://qamarero.com/graphql',
  fr: 'https://qamarero.com/fr/graphql',
};

export async function getPostsByLang(lang: 'es' | 'fr') {
  const endpoint = GRAPHQL_ENDPOINTS[lang];
  // Query GraphQL...
}
```

**Tests:**
```
Test A: Endpoints independientes
1. Fetch /graphql â†’ Solo posts ES
2. Fetch /fr/graphql â†’ Solo posts FR
3. NO hay mezcla âœ…
```

**MÃ©tricas:**
- [ ] Endpoints funcionan independientes
- [ ] GraphQL responde <500ms

---

## ğŸ“Š IntegraciÃ³n con Astro

### Estructura de archivos

```
src/pages/
â”œâ”€â”€ blog/
â”‚   â”œâ”€â”€ index.astro              # ES: /blog (fetch a /graphql)
â”‚   â””â”€â”€ [slug].astro             # ES: /blog/post
â”œâ”€â”€ fr/
â”‚   â””â”€â”€ blog/
â”‚       â”œâ”€â”€ index.astro          # FR: /fr/blog (fetch a /fr/graphql)
â”‚       â””â”€â”€ [slug].astro         # FR: /fr/blog/post
â””â”€â”€ en/
    â””â”€â”€ blog/
        â”œâ”€â”€ index.astro          # EN: /en/blog (fetch a /en/graphql)
        â””â”€â”€ [slug].astro         # EN: /en/blog/post
```

### Ejemplo componente

```astro
---
// src/pages/blog/index.astro (ES)
import { getPostsByLang } from '../../lib/wordpress';

const posts = await getPostsByLang('es'); // Fetch a /graphql
---

<Layout title="Blog - Qamarero">
  <ul>
    {posts.map(post => (
      <li><a href={`/blog/${post.slug}`}>{post.title}</a></li>
    ))}
  </ul>
</Layout>
```

```astro
---
// src/pages/fr/blog/index.astro (FR)
import { getPostsByLang } from '../../../lib/wordpress';

const posts = await getPostsByLang('fr'); // Fetch a /fr/graphql
---

<Layout title="Blog - Qamarero France">
  <ul>
    {posts.map(post => (
      <li><a href={`/fr/blog/${post.slug}`}>{post.title}</a></li>
    ))}
  </ul>
</Layout>
```

---

## âœ… Criterios Go/No-Go

### Criterios de Ã‰xito

- [ ] **SegregaciÃ³n:** Editor ES NO puede acceder a admin FR
- [ ] **SegregaciÃ³n:** Editor FR NO puede acceder a admin ES
- [ ] **Contenido:** Posts son independientes (sin relaciÃ³n)
- [ ] **AutonomÃ­a:** Cada site configura plugins/SEO independiente
- [ ] **Escalabilidad:** AÃ±adir site IT <15 min
- [ ] **GraphQL:** Endpoints independientes funcionan

### DecisiÃ³n Gate

```
TODOS criterios âœ…?
â”‚
â”œâ”€ SÃ­ â†’ âœ… APROBAR Multisite
â”‚        â””â”€ Pasar a 4.2 (Multi-idioma en cÃ³digo)
â”‚
â””â”€ No â†’ âš ï¸ ITERAR sobre problema especÃ­fico
```

---

## ğŸ“š Referencias

- **ADR-009:** URLs Multi-idioma con Subfolders
- **1.2:** ElecciÃ³n de CMS (WordPress)
- **Caso real:** Lole/Cabify usÃ³ Multisite para 8+ paÃ­ses con contenido independiente

---

**Preparado por:** Miguel Ortiz Peralta
**Fecha:** 3 Febrero 2026
**VersiÃ³n:** 3.0
**Estado:** â³ Pendiente de validar en POC
